<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PWHL Analytics</title>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png?v=2">
  <link rel="icon" href="/favicon.ico?v=2">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='PWHL_logo.png', v='2') }}">
  <meta name="theme-color" content="#160A3A">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LQY14MGCDV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LQY14MGCDV');
  </script>

  <style>
    :root { --pwhl-bg-1:#160A3A; --pwhl-bg-2:#251055; --pwhl-bg-3:#3B1E7A; --pwhl-surface:rgba(19,13,46,.75); --pwhl-surface-strong:rgba(25,16,60,.85); --pwhl-border:rgba(142,124,214,.25); --pwhl-accent:#8E7CD6; --pwhl-accent-strong:#B9A7FF; --pwhl-bad:#E15D64; --pwhl-good:#42d392; }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,var(--pwhl-bg-1),var(--pwhl-bg-2) 48%,var(--pwhl-bg-3));color:#fff;min-height:100vh;display:flex;flex-direction:column;}
    header{display:flex;align-items:center;justify-content:space-between;padding:1rem 2rem;background:var(--pwhl-surface-strong);border-bottom:1px solid var(--pwhl-border);} 
    header h1{font-size:1.5rem;font-weight:700;display:inline-flex;align-items:center;gap:.75rem;}
    .tabs{display:flex;background:var(--pwhl-surface-strong);border-bottom:1px solid var(--pwhl-border);margin-top:.75rem;}
    .tab{background:transparent;color:#d6d3e9;border:none;padding:1rem 2rem;cursor:pointer;border-bottom:3px solid transparent;transition:.2s;font-size:1.05rem;text-decoration:none;display:flex;align-items:center;gap:.4rem;font-weight:600;}
    .tab:hover{color:#fff;text-decoration:none;}
    .tab.active{color:var(--pwhl-accent-strong);border-bottom-color:var(--pwhl-accent-strong);text-decoration:none;}

    main{flex:1;display:flex;flex-direction:column;align-items:center;gap:1rem;padding:2rem 1rem 2.5rem;}
    .card{width:min(760px, 100%);background:var(--pwhl-surface);border:1px solid var(--pwhl-border);border-radius:1rem;padding:1.25rem 1.25rem 1.35rem;}
    .title{display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap;}
    .title h2{font-size:1.25rem;font-weight:700;color:var(--pwhl-accent-strong);}
    .subtitle{margin-top:.35rem;color:rgba(203,213,225,.85);font-size:.95rem;line-height:1.45;}

    .alert{margin-top:1rem;border-radius:.75rem;padding:.75rem .9rem;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.04);}
    .alert.good{border-color:rgba(66,211,146,.35);background:rgba(66,211,146,.08);}
    .alert.bad{border-color:rgba(225,93,100,.35);background:rgba(225,93,100,.08);}
    .alert strong{display:block;margin-bottom:.15rem;}

    .actions{margin-top:1.1rem;display:flex;gap:.75rem;flex-wrap:wrap;}
    .btn{background:var(--pwhl-accent);color:#fff;border:none;padding:.55rem 1rem;border-radius:.55rem;cursor:pointer;font-size:.9rem;font-weight:600;transition:background-color .2s;}
    .btn:hover{background:var(--pwhl-accent-strong);}
    .btn.secondary{background:#4a5568;}
    .btn.secondary:hover{background:#718096;}

    .fineprint{margin-top:.75rem;color:rgba(203,213,225,.70);font-size:.78rem;}
    .fineprint a{color:var(--pwhl-accent-strong);text-decoration:underline;}

    footer{padding:.4rem .9rem;font-size:.6rem;color:#8684a3;text-align:center;border-top:1px solid var(--pwhl-border);background:var(--pwhl-surface-strong);margin-top:.25rem;}

    /* Mobile top menu + (optional) slicers toggle (mobile-only) */
    .mobile-actions{display:none;align-items:center;gap:.6rem;}
    .mobile-icon-btn{width:44px;height:44px;border-radius:12px;background:rgba(142,124,214,.85);border:1px solid rgba(255,255,255,.18);color:#0b0b14;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;}
    .mobile-icon-btn svg{width:22px;height:22px;stroke:#0b0b14;}
    .mobile-icon-btn.active{outline:2px solid rgba(255,255,255,.95);outline-offset:2px;}
    .mobile-menu-backdrop{display:none;position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:999;}
    .mobile-menu-panel{display:none;position:fixed;top:76px;left:1rem;right:1rem;background:var(--pwhl-surface-strong);border:1px solid var(--pwhl-border);border-radius:1rem;overflow:hidden;z-index:1000;}
    .mobile-menu-list{list-style:none;margin:0;padding:0;}
    .mobile-menu-list a{display:block;padding:1rem 1rem;color:#fff;text-decoration:none;border-top:1px solid rgba(255,255,255,.08);font-weight:650;font-size:1.1rem;}
    .mobile-menu-list a:first-child{border-top:none;}
    .mobile-menu-list a.active{background:rgba(142,124,214,.18);}
    body.mobile-menu-open .mobile-menu-backdrop{display:block;}
    body.mobile-menu-open .mobile-menu-panel{display:block;}
    /* Treat "mobile" as coarse-pointer devices (phones/tablets), regardless of rotation */
    @media (max-width: 1100px) and (hover: none) and (pointer: coarse){
      .tabs{display:none !important;}
      header{padding:.75rem 1rem;}
      .mobile-actions{display:flex;}
      main{padding:1.1rem .75rem 2.5rem;}
    }
  </style>
</head>
<body>
  <header>
    <h1><img src="{{ url_for('static', filename='PWHL_logo.png') }}" alt="PWHL" style="height:28px;width:auto;"> <span>PWHL Analytics</span></h1>
    <div class="mobile-actions" aria-label="Mobile controls">
      <button class="mobile-icon-btn" id="mobileMenuBtn" type="button" aria-label="Menu" aria-expanded="false">
        <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 6h16" /><path d="M4 12h16" /><path d="M4 18h16" />
        </svg>
      </button>
      <button class="mobile-icon-btn" id="mobileSlicersBtn" type="button" aria-label="Slicers" aria-expanded="false">
        <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 6h16" /><path d="M7 12h10" /><path d="M10 18h4" />
        </svg>
      </button>
    </div>
  </header>

  <!-- Mobile menu overlay (mobile-only via CSS) -->
  <div class="mobile-menu-backdrop" id="mobileBackdrop" aria-hidden="true"></div>
  <nav class="mobile-menu-panel" id="mobileMenuPanel" aria-label="Menu" aria-hidden="true">
    <ul class="mobile-menu-list">
      <li><a href="/">Schedule</a></li>
      <li><a href="/report">Report</a></li>
      <li><a href="/skaters">Skaters</a></li>
      <li><a href="/goalies">Goalies</a></li>
      <li><a href="/teams">Teams</a></li>
      <li><a href="/data">Data</a></li>
      <li><a class="active" href="/coffee">Buy me a coffee</a></li>
    </ul>
  </nav>

  <div class="tabs">
    <a class="tab" href="/">üìÖ Schedule</a>
    <a class="tab" href="/report">üìä Report</a>
    <a class="tab" href="/skaters">üèí Skaters</a>
    <a class="tab" href="/goalies" aria-label="Goalies">
      <svg aria-hidden="true" viewBox="0 0 24 24" width="16" height="16" focusable="false" fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 3c4.4 0 7.8 2.6 7.8 7.2 0 6-4.2 11-7.8 11.3C8.4 21.2 4.2 16.2 4.2 10.2 4.2 5.6 7.6 3 12 3z"/>
        <path d="M7.2 10.4c.1-3 2.1-5 4.8-5s4.7 2 4.8 5"/>
        <path d="M9 4.7h6"/>
        <path d="M8.1 6.2h1.4M14.5 6.2h1.4"/>
        <path d="M8 11.2c1.2 1 2.7 1.6 4 1.6s2.8-.6 4-1.6"/>
        <path d="M8.2 13.1h7.6"/>
        <path d="M9.1 15h5.8"/>
        <path d="M12 10.6v5.2"/>
        <path d="M10.2 10.9v4.8"/>
        <path d="M13.8 10.9v4.8"/>
      </svg>
      Goalies
    </a>
    <a class="tab" href="/teams">üèüÔ∏è Teams</a>
    <a class="tab" href="/data">üóÇÔ∏è Data</a>
    <a class="tab active" href="/coffee">‚òï Buy me a coffee</a>
  </div>

  <main>
    <div class="card">
      <div class="title">
        <h2>Buy me a coffee</h2>
      </div>
      <div class="subtitle">
        If you enjoy the site and want to support development, you can send a one-time tip via Stripe Checkout.
      </div>

      {% if success %}
        <div class="alert good">
          <strong>Thanks for the support!</strong>
          Your payment was completed.
        </div>
      {% elif canceled %}
        <div class="alert bad">
          <strong>Checkout canceled.</strong>
          No payment was processed.
        </div>
      {% endif %}

      {% if not stripe_enabled %}
        <div class="alert bad" style="margin-top:1rem;">
          <strong>Stripe is not configured.</strong>
          Set <code style="color:#fff;">STRIPE_SECRET_KEY</code> on the server to enable checkout.
        </div>
      {% endif %}

      <div class="actions">
        <button class="btn" type="button" onclick="startCheckout(3)" {% if not stripe_enabled %}disabled style="opacity:.55;cursor:not-allowed;"{% endif %}>$3</button>
        <button class="btn" type="button" onclick="startCheckout(5)" {% if not stripe_enabled %}disabled style="opacity:.55;cursor:not-allowed;"{% endif %}>$5</button>
        <button class="btn" type="button" onclick="startCheckout(10)" {% if not stripe_enabled %}disabled style="opacity:.55;cursor:not-allowed;"{% endif %}>$10</button>
        <button class="btn" type="button" onclick="startCheckout(20)" {% if not stripe_enabled %}disabled style="opacity:.55;cursor:not-allowed;"{% endif %}>$20</button>
        <button class="btn" type="button" onclick="startCheckout(50)" {% if not stripe_enabled %}disabled style="opacity:.55;cursor:not-allowed;"{% endif %}>$50</button>
        <a class="btn secondary" href="/" style="text-decoration:none;display:inline-flex;align-items:center;">Back</a>
      </div>

      <div class="fineprint">
        You‚Äôll be redirected to Stripe Checkout. This is a one-time payment.
      </div>
    </div>
  </main>

  <footer>¬© PWHL Analytics</footer>

  <script>
    async function startCheckout(amountDollars){
      try{
        const res = await fetch('/api/stripe/create-checkout-session', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ amount: amountDollars })
        });
        const data = await res.json().catch(()=>({}));
        if(!res.ok){
          const msg = (data && data.error) ? data.error : 'Unable to start checkout.';
          alert(msg);
          return;
        }
        if(data && data.url){
          window.location.assign(data.url);
          return;
        }
        alert('Unable to start checkout.');
      }catch(e){
        alert('Unable to start checkout.');
      }
    }
  </script>

  <script>
    // Mobile: menu toggle (slicers button auto-hides on pages without slicers)
    (function setupMobileToggles(){
      const menuBtn=document.getElementById('mobileMenuBtn');
      const slicersBtn=document.getElementById('mobileSlicersBtn');
      const backdrop=document.getElementById('mobileBackdrop');
      const menuPanel=document.getElementById('mobileMenuPanel');

      function setMenuOpen(open){
        document.body.classList.toggle('mobile-menu-open', open);
        if(menuBtn) menuBtn.classList.toggle('active', open);
        if(menuBtn) menuBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
        if(menuPanel) menuPanel.setAttribute('aria-hidden', open ? 'false' : 'true');
        if(backdrop) backdrop.setAttribute('aria-hidden', open ? 'false' : 'true');
      }
      function closeAll(){ setMenuOpen(false); }

      // No global slicers on this page
      if(slicersBtn) slicersBtn.style.display='none';

      if(menuBtn){
        menuBtn.addEventListener('click', ()=>{
          const next=!document.body.classList.contains('mobile-menu-open');
          setMenuOpen(next);
        });
      }
      if(backdrop) backdrop.addEventListener('click', closeAll);
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeAll(); });
    })();
  </script>
</body>
</html>
